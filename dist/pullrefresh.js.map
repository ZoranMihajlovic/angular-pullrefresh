{"version":3,"sources":["js/directive.js","js/template.js"],"names":["PubSub","handlers","event","handler","context","push","bind","i","args","length","Pan","options","resistance","_options","reset","_distance","_start","_isScrolling","_didMove","val","pos","Math","round","distance","PullRefresh","arguments","_el","el","threshold","_state","pubSub","resetState","scrollTop","calcDistance","isScrolling","isScrolledToTop","refresh","pull","publish","scroll","didMove","TOUCH_START","TOUCH_MOVE","TOUCH_END","defaults","contentOffset","angular","window","require","undefined","pullrefresh","module","directive","$window","$document","transclude","restrict","scope","ptrStyle","hideLoader","pullrefreshElement","templateUrl","link","linkPullrefreshDirective","$scope","element","attrs","contentStyle","pullrefreshContentOffset","pullrefreshThreshold","pullrefreshResistance","ptrEl","body","elements","document","querySelectorAll","ptrElClassList","classList","pan","activate","isLoading","subscribe","state","setContentPan","doLoading","doReset","listen","touchStart","touchMove","touchEnd","evt","split","toLowerCase","addEventListener","e","t","touches","begin","clientY","move","preventDefault","stopPropagation","end","offset","getContentOffset","loaderOffset","getLoaderOffset","transform","webkitTransform","$apply","querySelector","offsetHeight","add","loadingPromise","$eval","setTimeout","then","remove","elClassRemove","removeEventListener","run","$templateCache","put"],"mappings":"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","file":"pullrefresh.js","sourcesContent":["(function() {\n  'use strict';\n\n  class PubSub {\n\n    constructor () {\n      this.handlers = [];\n    }\n\n    subscribe (event, handler, context) {\n\n      if (typeof context === 'undefined') {\n        context = handler;\n      }\n\n      this.handlers.push({\n        event: event,\n        handler: handler.bind(context)\n      });\n\n      return this;\n    }\n\n    publish (event, ...args) {\n      let i = 0;\n\n      for (; i < this.handlers.length; i += 1) {\n\n          if (this.handlers[i].event === event) {\n              this.handlers[i].handler(...args);\n          }\n\n      }\n    }\n  }\n\n\n  class Pan {\n\n  constructor (options = {resistance : 1}) {\n    this._options = options;\n\n    this.reset();\n  }\n\n  get distance () {\n    return this._distance;\n  }\n\n  get isScrolling () {\n    return this._isScrolling;\n  }\n\n  get didMove () {\n    return this._didMove;\n  }\n\n  reset () {\n    this._distance = 0;\n    this._start = 0;\n    this._isScrolling = false;\n    this._didMove = false;\n  }\n\n  begin (val) {\n    this._start = val;\n  }\n\n  calcDistance (pos) {\n    return Math.round((pos - this._start) / this._options.resistance);\n  }\n\n  move (distance) {\n    this._distance = distance;\n    this._didMove = true;\n    this._isScrolling = false;\n  }\n\n  scroll () {\n    this._isScrolling = true;\n    this._didMove = false;\n  }\n\n}\n\n  class PullRefresh extends Pan {\n\n    constructor () {\n\n      super(...arguments);\n\n      this._el = this._options.el;\n\n      this._options.threshold = this._options.threshold || 0;\n\n      this._state = {};\n\n      this.pubSub = new PubSub();\n\n    }\n\n    get el () {\n      return this._el;\n    }\n\n    get state () {\n      return this._state;\n    }\n\n    reset () {\n      super.reset();\n      this.resetState();\n    }\n\n    resetState () {\n      this._state = {};\n    }\n\n    isScrolledToTop () {\n      return this._el.scrollTop === 0;\n    }\n\n    move (pos, event) {\n\n      let distance = this.calcDistance(pos);\n\n      if (!this.isScrolling &&\n        this.isScrolledToTop() &&\n        distance > 0) {\n\n        super.move(distance);\n\n        this._state.refresh = this.distance > this._options.threshold;\n        this._state.pull = this.distance > 0;\n\n        this.pubSub.publish('moved', this);\n\n        return true;\n      }\n      else {\n\n        this.scroll();\n\n        return false;\n      }\n\n    }\n\n\n    end () {\n\n      if (this.didMove) {\n\n        this.pubSub.publish('end', this);\n\n        this.reset();\n\n        return true;\n      }\n    }\n\n\n  }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  'use strict';\n\n  const TOUCH_START = 'touchstart MSPointerDown pointerdown';\n  const TOUCH_MOVE = 'touchmove MSPointerMove MSPointerHover pointermove';\n  const TOUCH_END = 'touchend touchcancel MSPointerUp MSPointerCancel pointerup pointercancel';\n\n  const defaults = {\n    contentOffset : null,\n    threshold : 70,\n    resistance : 2.5\n  };\n\n  /* istanbul ignore next */\n  let angular = window.angular ?\n    window.angular :\n    'undefined' !== typeof require ?\n      require('angular') :\n      undefined;\n\n  let pullrefresh = angular.module('pullrefresh', []);\n\n\n\n\n  /* @ngInject */\n  pullrefresh.directive('pullrefresh', ['$window', '$document', function($window, $document) {\n\n    return {\n\n      transclude : true,\n\n      restrict: 'EA',\n\n      scope : {\n        // make the internal loader state known to external\n        // components\n        ptrStyle : '=pullrefreshLoaderStyle',\n\n        hideLoader : '=pullrefreshHideLoader',\n\n        // make the callback is evaluated on the parent scope\n        pullrefresh : '&',\n\n        pullrefreshElement: '@'\n      },\n\n      templateUrl: 'template/pullrefresh/pullrefresh.html',\n\n      link: linkPullrefreshDirective\n\n    };\n\n\n\n\n\n    ///////////////////////////////////////////////////////////\n\n\n\n    function linkPullrefreshDirective($scope, element, attrs) {\n\n      $scope.contentStyle = {};\n      $scope.ptrStyle = {};\n\n\n\n      /**\n       * Hold all of the merged parameter and default module options\n       * @type {object}\n       */\n      let options = {\n        contentOffset : attrs.pullrefreshContentOffset || defaults.contentOffset,\n        threshold: attrs.pullrefreshThreshold || defaults.threshold,\n        resistance: attrs.pullrefreshResistance || defaults.resistance || 1\n      };\n\n      /**\n       * Easy shortener for handling adding and removing body classes.\n       */\n      let ptrEl = $document[0].body;\n      if ($scope.pullrefreshElement) {\n        let elements = document.querySelectorAll($scope.pullrefreshElement);\n        if (elements.length > 0) {\n          ptrEl = elements[0];\n        }\n      }\n\n      let ptrElClassList = ptrEl.classList;\n\n      /**\n       * Holds all information about the current pan action\n       */\n      let pan = new PullRefresh({\n        el : ptrEl,\n        threshold : options.threshold,\n        resistance : options.resistance\n      });\n\n\n\n\n      activate();\n\n      ////////////\n\n      function activate() {\n        pan.reset();\n\n        pan.isLoading = false;\n\n        pan.pubSub\n        .subscribe('moved', (pan) => {\n\n          ptrElClassList[pan.state.refresh ? 'add' : 'remove']('ptr-refresh');\n          ptrElClassList[pan.state.pull ? 'add' : 'remove']('ptr-pull');\n\n          setContentPan(pan);\n        });\n\n\n\n        pan.pubSub.subscribe('end', (pan) => {\n          setContentPan(null);\n\n          if (pan.state.refresh) {\n            doLoading(pan);\n          } else {\n            doReset(pan);\n          }\n\n        });\n\n        listen(ptrEl, TOUCH_START, touchStart);\n        listen(ptrEl, TOUCH_MOVE, touchMove);\n        listen(ptrEl, TOUCH_END, touchEnd);\n      }\n\n      function listen(el, evt, handler) {\n\n        evt = evt.split(' ');\n        let i = 0;\n\n        while (evt[i] && !(`on${evt[i].toLowerCase()}` in $window)) {\n          i += 1;\n        }\n\n        if (i < evt.length) {\n          evt = evt[i];\n        }\n\n        el.addEventListener(evt, handler, false);\n\n      }\n\n\n\n      /**\n       * Determine whether pan events should apply based on scroll position on panstart\n       *\n       * @param {object} e - Event object\n       */\n      function touchStart (e) {\n\n        pan.reset();\n\n        if (pan.isLoading) {\n          return;\n        }\n\n        let t = e.touches ? e.touches[0] : e;\n\n        pan.begin(t.clientY);\n\n      }\n\n      /**\n       * Handle element on screen movement when the pandown events is firing.\n       *\n       * @param {object} e - Event object\n       */\n      function touchMove (e) {\n\n        if (pan.isLoading) {\n          return;\n        }\n\n        let t = e.touches ? e.touches[0] : e;\n\n        if (pan.move(t.clientY)) {\n          e.preventDefault();\n          e.stopPropagation();\n        }\n\n      }\n\n      function touchEnd (e) {\n\n        if (pan.isLoading) {\n          return;\n        }\n\n        if (pan.end()) {\n          e.preventDefault();\n          e.stopPropagation();\n        }\n\n      }\n\n\n\n\n\n\n\n\n      /**\n       * Set the CSS transform on the content element to move it on the screen.\n       */\n      function setContentPan (pan) {\n\n        if (pan === null) {\n\n          $scope.contentStyle = {};\n          $scope.ptrStyle = {};\n\n        }\n        else {\n\n          let offset = getContentOffset(options);\n\n          // in case the default loader is being hidden, use the negative\n          // pan distance to keep the loader atop\n          let loaderOffset = getLoaderOffset(pan, offset);\n\n            // Use transforms to smoothly animate elements on desktop and mobile devices\n          $scope.contentStyle = {\n            transform: 'translate3d(0, ' + pan.distance + 'px, 0)',\n            webkitTransform: 'translate3d(0, ' + pan.distance + 'px, 0)'\n          };\n\n          $scope.ptrStyle = {\n            transform: 'translate3d(0, ' + loaderOffset + 'px, 0)',\n            webkitTransform: 'translate3d(0, ' + loaderOffset + 'px, 0)'\n          };\n\n        }\n\n        $scope.$apply();\n      }\n\n\n\n\n      function getContentOffset () {\n        return options.contentOffset !== null ?\n          options.contentOffset :\n          element[0].querySelector('.ptr').offsetHeight;\n      }\n\n      function getLoaderOffset (pan, offset) {\n        return $scope.hideLoader ?\n          (-pan.distance - offset) :\n          pan.distance - offset;\n      }\n\n      /**\n       * Position content and refresh elements to show that loading is taking place.\n       */\n      function doLoading (pan) {\n        pan.isLoading = true;\n        ptrElClassList.add('ptr-loading');\n\n        // If no valid loading function exists, just reset elements\n        if (!$scope.pullrefresh) {\n          return doReset(pan);\n        }\n\n        // The loading function should return a promise\n        let loadingPromise = $scope.$eval($scope.pullrefresh);\n\n        // For UX continuity, make sure we show loading for at least one second before resetting\n        setTimeout(function() {\n\n          if (loadingPromise.then) {\n            // Once actual loading is complete, reset pull to refresh\n            loadingPromise.then(() => doReset(pan));\n          }\n\n        }, 1000);\n      }\n\n      /**\n       * Reset all elements to their starting positions before any paning took place.\n       */\n      function doReset (pan) {\n        ptrElClassList.remove('ptr-loading');\n        ptrElClassList.remove('ptr-refresh');\n        ptrElClassList.add('ptr-reset');\n\n        let elClassRemove = function() {\n          ptrElClassList.remove('ptr-reset');\n          ptrElClassList.remove('ptr-pull');\n\n          pan.el.removeEventListener('transitionend', elClassRemove, false);\n        };\n\n        pan.el.addEventListener('transitionend', elClassRemove, false);\n\n\n        pan.isLoading = false;\n      }\n\n    }\n  }]);\n\n})();\n","(function() {\n\n  'use strict';\n\n  /* istanbul ignore next */\n  var angular = window.angular ? window.angular : 'undefined' !== typeof require ? require('angular') : undefined;\n\n\n  angular.module('pullrefresh')\n    .run(['$templateCache', function($templateCache) {\n      $templateCache.put('template/pullrefresh/pullrefresh.html',\n        '<div ng-if=\"!hideLoader\" ng-style=\"ptrStyle\" class=\"ptr\">' +\n            '<span class=\"genericon genericon-next\"></span>' +\n\n            '<div class=\"loading\">' +\n                '<span class=\"l1\"></span>' +\n                '<span class=\"l2\"></span>' +\n                '<span class=\"l3\"></span>' +\n            '</div>' +\n        '</div>' +\n\n        '<div ng-style=\"contentStyle\" class=\"ptr-content\">' +\n          //'Pull down to refresh!' +\n          '<div ng-transclude></div>' +\n        '</div>');\n    }]);\n\n})();\n"]}